<!DOCTYPE html>
<html lang="en">
<head>
    <link rel="stylesheet" type="text/css" href="http://fonts.googleapis.com/css?family=Josefin Slab">
    <link rel="stylesheet" href="https://maxcdn.bootstrapcdn.com/bootstrap/3.3.7/css/bootstrap.min.css">
    <script src="https://ajax.googleapis.com/ajax/libs/jquery/3.1.1/jquery.min.js"></script>
    <script src="https://maxcdn.bootstrapcdn.com/bootstrap/3.3.7/js/bootstrap.min.js"></script>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1">
    <title>TWPICS</title>

    <script>

        var username;
        var image_elem;
        var url = "{% url 'showPic:userData' %}";
        console.log(url)

        function show_pict(image_url){
           console.log('in picture'+image_url)
           var loc = document.getElementById('my-container')
           var imgs = document.getElementById('myimg')
           console.log('imgs is'+imgs)
           if(imgs){
                    image_elem.setAttribute("src", image_url);
           }
           else{
                    image_elem = document.createElement('img');
                    image_elem.setAttribute("src", image_url);
                    image_elem.setAttribute("height", "100");
                    image_elem.setAttribute("width", "100");
                    image_elem.setAttribute("alt", "picture");
                    image_elem.setAttribute("display","block");
                    image_elem.setAttribute("id","myimg");
                    image_elem.classList.add("img-circle")
                    image_elem.classList.add("img-responsive")
                    image_elem.classList.add("center-block")
                    loc.appendChild(image_elem)
           }




        }

        function sendUserName(){
            console.log('in send')
            var name  ={'name':username};
            console.log('name is '+username);
            $.post(url,name,function(response){
                if (typeof response === 'string' || response instanceof String){
                 show_pict(response);}
                else{
                    alert('ERRORRRRRR');
                }
            });
        }

        /*
        $(document).ready(function(){

            $('#sb_btn').click(function(){
                username = document.getElementById('name').value;
                console.log(username)
                sendUserName();
            });
        });*/

            $(document).ready(function(){
                $("#submit").submit(function(event){
                console.log("HEY")
                console.log(document.getElementById('name').value);
                username = document.getElementById('name').value;
                if(username){
                    console.log('xxxxxxxxxxxxx'+username)
                    sendUserName();
                    event.preventDefault();
                }
                else{
                    console.log("plz enter valid username")
                    event.preventDefault();
                }

                });
            });
    </script>

    <style>
        body{
             font-size:40px;
             font-family:Josefin Slab;
             size:40px;
        }
        #name{
            font-size:40px;
            width:350px;
            height:50px;
        }

        #submit{
            text-align:center;
        }

        @media(max-width:767px){
            #name{
                width:100%;
                font-size:40px;
                height:50px;
            }
            #submit{
                text-align:center;
            }
        }
    </style>
</head>
<body>
    <div class="container" id="my-container">
        <div class="row">
            <div class="col-md-4 col-xs-12"></div>

            <div class="col-md-4 col-xs-12">
                <form  class="form-inline" id="submit" method="post">
                    {% csrf_token %}
                    <div class="form-group has-success" id="block">
                        <label for="name">Name</label>
                        <input type="text" class="form-control form-control-has-success" name="username" id="name">
                        <button type="submit" class="btn btn-primary btn-lg">submit</button>
                    </div>
                </form>
            </div>
            <div class="col-md-4 col-xs-12"></div>
        </div>
    </div>
</body>
</html>
